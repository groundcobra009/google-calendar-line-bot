# 🚀 クイックスタートガイド

## 概要
このガイドでは、GoogleカレンダーLINEbotを最短時間で動作させるための手順を説明します。

## ⏱️ 所要時間
約15-20分

## 📋 必要なもの
- Googleアカウント
- LINE Developersアカウント
- スマートフォン（LINE User ID取得用）

---

## Step 1: LINE Developers設定 (5分)

### 1-1. LINE Developersアカウント作成
1. [LINE Developers](https://developers.line.biz/) にアクセス
2. LINEアカウントでログイン
3. 初回の場合は開発者登録を行う

### 1-2. プロバイダー作成
1. 「Create」ボタンをクリック
2. 「Create a new provider」を選択
3. プロバイダー名を入力（例：「MyCalendarBot」）

### 1-3. チャンネル作成
1. 作成したプロバイダーをクリック
2. 「Create a new channel」をクリック
3. 「Messaging API」を選択
4. 必要情報を入力：
   - **Channel name**: カレンダーbot（任意の名前）
   - **Channel description**: Googleカレンダー連携bot
   - **Category**: Tools
   - **Subcategory**: その他

### 1-4. 重要情報を取得
チャンネル作成後、以下の情報をメモ：

1. **Channel Access Token**
   - 「Messaging API設定」タブ
   - 「Channel access token」の「Issue」をクリック
   - 生成されたトークンをコピー

2. **User ID取得方法**
   - QRコードまたは LINE IDで友達追加
   - 作成したbotに「test」とメッセージ送信
   - 後でWebhook設定後にUser IDを確認

---

## Step 2: Google Apps Script設定 (8分)

### 2-1. GASプロジェクト作成
1. [Google Apps Script](https://script.google.com/) にアクセス
2. 「新しいプロジェクト」をクリック
3. プロジェクト名を「カレンダーLINEbot」に変更

### 2-2. コードの設定
1. `Code.gs` の内容を全て削除
2. 提供された `Code.gs` の内容をコピー&ペースト
3. 「ファイル」→「新規作成」→「スクリプトファイル」で `Utils.gs` を作成
4. 提供された `Utils.gs` の内容をペースト
5. 「ファイル」→「新規作成」→「マニフェストファイル」で `appsscript.json` を作成
6. 提供された `appsscript.json` の内容をペースト

### 2-3. スプレッドシート作成
1. 「リソース」→「ライブラリ」→「このスクリプトに関連付けられたスプレッドシートを作成」
2. スプレッドシートが開いたら名前を「カレンダーLINEbot設定」に変更

---

## Step 3: 初期設定 (5分)

### 3-1. 権限許可
1. GASエディタで `onOpen` 関数を選択
2. 「実行」ボタンをクリック
3. 権限許可画面で「詳細」→「〜(安全ではないページ)に移動」
4. 「許可」をクリック

### 3-2. スプレッドシート設定
1. 作成したスプレッドシートを開く
2. メニューバーに「📅 カレンダーLINEbot」が表示されることを確認
3. 「📝 設定シートを初期化」をクリック

### 3-3. 設定値入力
「カレンダー設定」シートで以下を入力：

| セル | 項目 | 値 |
|------|------|-----|
| B1 | GoogleカレンダーID | あなたのGmail or カレンダーID |
| B2 | LINE Channel Access Token | Step 1で取得したトークン |
| B3 | LINE User ID | （後で設定） |
| B4 | Webhook Verify Token | （任意・空白可） |

**カレンダーID取得方法:**
1. [Googleカレンダー](https://calendar.google.com/) を開く
2. 左サイドバーで使用したいカレンダーの「⋮」→「設定と共有」
3. 「カレンダーの統合」セクションで「カレンダーID」をコピー

---

## Step 4: デプロイとWebhook設定 (3分)

### 4-1. Webアプリとしてデプロイ
1. GASエディタで「デプロイ」→「新しいデプロイ」
2. 設定：
   - **種類**: ウェブアプリ
   - **実行者**: 自分
   - **アクセスできるユーザー**: 全員
3. 「デプロイ」をクリック
4. **ウェブアプリのURL**をコピー

### 4-2. LINE Webhook設定
1. LINE Developers コンソールに戻る
2. 「Messaging API設定」タブを開く
3. **Webhook URL**に Step 4-1 でコピーしたURLを貼り付け
4. **Webhookの利用**: オン
5. **応答メッセージ**: オフ
6. 「検証」ボタンをクリックして成功を確認

---

## Step 5: User ID取得と最終テスト (2分)

### 5-1. User ID取得
1. 作成したLINE botに「test」とメッセージ送信
2. GASエディタのログを確認してUser IDを取得
3. スプレッドシートのB3セルにUser IDを入力

### 5-2. テスト実行
1. スプレッドシートのメニュー「📤 今日のイベントを手動送信」をクリック
2. LINEに今日の予定が送信されれば成功！

---

## 🎉 完了！

### 自動送信設定
朝8時に自動送信したい場合：
- メニュー「⏰ 朝8時の自動送信を設定」をクリック

### LINEbotコマンド
LINE botに以下を送信：
- `今日の予定`: 今日の予定を表示
- `明日の予定`: 明日の予定を表示
- `今週の予定`: 今週の予定を表示
- `ヘルプ`: 使い方を表示

---

## 🔧 トラブルシューティング

### よくある問題と解決方法

**「カレンダーIDが見つかりません」**
- カレンダーIDが正しいかGoogleカレンダーで再確認
- プライベートカレンダーの場合は共有設定を確認

**「LINE送信エラー」**
- Channel Access Tokenが正しいか確認
- User IDが正しく設定されているか確認

**「権限エラー」**
- GASの権限許可を再実行
- ブラウザのポップアップブロック設定を確認

**「Webhook接続エラー」**
- GASが正しくデプロイされているか確認
- Webhook URLが正確にコピーされているか確認

### デバッグ方法
1. GASエディタの「表示」→「ログ」でエラー詳細を確認
2. 「🔍 設定状況を確認」メニューで設定の妥当性をチェック
3. `testGetTodayEvents` 関数を実行してカレンダー接続をテスト

---

## 📞 サポート
設定でご不明な点がある場合は、README.mdの詳細説明をご確認ください。 